"use strict";(self.webpackChunk_uniswap_interface=self.webpackChunk_uniswap_interface||[]).push([[5850],{54023:(e,i,t)=>{t.r(i),t.d(i,{default:()=>o});const o={}},81738:(e,i,t)=>{t.r(i),t.d(i,{default:()=>o});const o={}},60521:(e,i,t)=>{t.r(i),t.d(i,{default:()=>o});const o={}},71754:(e,i,t)=>{t.d(i,{w:()=>_});var o=t(84250),n=t(66112),r=t(39891),s=t(83637),a=t(48006),c=t(78307),l=t(14632),u=t(53867),d=t(33996),p=t(61578);const x="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _position-absolute _top-0 _right-0 _pt-t-space-spa94665589 _pr-t-space-spa94665589 _pb-t-space-spa94665589 _pl-t-space-spa94665589 ",m="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _justifyContent-space-betwe3241 _alignItems-center _gap-t-space-spa94665589 _width-10037 ";function _({title:e,closeModal:i,goBack:t}){const{t:_}=(0,r.$G)(),v=(0,n.useMemo)((()=>(0,o.jsx)(s.Su,{testId:"LiquidityModalHeader-close",onClose:i})),[i]);return(0,o.jsxs)("div",{className:m,children:[t?(0,o.jsx)(a.Z,{onPress:t,children:(0,o.jsx)(l.D,{color:"$neutral1",size:"$icon.24"})}):v,(0,o.jsx)(c.xv,{variant:"body2",flexGrow:1,textAlign:"center",pr:24,children:e}),t?(0,o.jsx)("div",{className:x,children:v}):(0,o.jsx)(u.h,{adjustTopAlignment:!1,settings:[p.p,d.o],defaultTitle:_("pool.positions.transaction.settings")})]})}t(60521)},94170:(e,i,t)=>{t.d(i,{s:()=>m});var o=t(84250),n=t(35872),r=t(18369),s=t(28592),a=t(78307),c=t(95675),l=t(53222),u=t(65980),d=t(52553);const p="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _flexGrow-1 ",x="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _alignItems-center ";function m({currencyAmount:e,currencyUSDAmount:i,isMigrating:t=!1}){var m,_,v;const{formatCurrencyAmount:f}=(0,l.Do)(),h=t?(0,s.Ct)(null===(m=e)||void 0===m?void 0:m.currency,n.Qe.V4):null===(_=e)||void 0===_?void 0:_.currency;return(0,o.jsxs)("div",{className:x,children:[(0,o.jsxs)("div",{className:p,children:[(0,o.jsxs)(a.xv,{variant:"heading2",children:[f({value:e,type:d.s.TokenNonTx})," ",(0,u.GD)(null===(v=h)||void 0===v?void 0:v.symbol)]}),(0,o.jsx)(a.xv,{variant:"body3",color:"$neutral2",children:f({value:i,type:d.s.FiatStandard})})]}),(0,o.jsx)(r.Z,{currency:h,size:c._.icon36})]})}t(81738)},55850:(e,i,t)=>{t.r(i),t.d(i,{default:()=>De});var o=t(84250),n=t(35872),r=t(9615),s=t(96777),a=t(71754),c=t(86414),l=t(94170),u=t(80403),d=t(28340),p=t(74875),x=t(85901),m=t(47891),_=t(81716),v=t(16799),f=t(91842),h=t(93923),g=t(28592),y=t(66112),b=t(63160),k=t(93014),j=t(59922),S=t(4990),I=t(38147);function C(e,i,t,o,n,r,s){try{var a=e[r](s),c=a.value}catch(l){return void t(l)}a.done?i(c):Promise.resolve(c).then(o,n)}function A(e){return function(){var i=this,t=arguments;return new Promise((function(o,n){var r=e.apply(i,t);function s(e){C(r,o,n,s,a,"next",e)}function a(e){C(r,o,n,s,a,"throw",e)}s(void 0)}))}}var T=t(60510),P=t(18328),w=t(42014),R=t(91548),N=t(7063),q=t(58177),E=t(4578),V=t(94239),M=t(96102),D=t(21605),L=t(58082);const z=(0,y.createContext)(void 0);function B({children:e,positionInfo:i}){var t,r,s,a,c;const l=(0,L.m)(),[u,d]=(0,y.useState)(!1),{derivedPositionInfo:p,positionState:x,currentTransactionStep:m}=(0,h.kU)(),{feeValue0:C,feeValue1:B}=(0,v.v_)(i),{derivedPriceRangeInfo:O,priceRangeState:{fullRange:$}}=(0,h.$s)(),H=(0,y.useMemo)((()=>{if(i&&l.address)return{simulateTransaction:!0,walletAddress:l.address,chainId:i.currency0Amount.currency.chainId,protocol:T.X.V3,positionToken:i.tokenId}}),[i,l.address]),{data:W,isLoading:F,error:Q,refetch:U}=(0,b.F)({params:H,headers:{"x-universal-router-version":P.w._2_0},staleTime:5*D.Yb,enabled:Boolean(H)});if(Q){const e=(0,q.z)(Q,{defaultTitle:"unknown CheckLpApprovalQuery"});M.k.error(e,{tags:{file:"MigrateV3LiquidityTxContext",function:"useEffect"}})}const G=!F&&Boolean(null===(t=W)||void 0===t?void 0:t.permitData),K=(0,y.useMemo)((()=>{var e,t,o,r,s,a,c,u;if(!p||!i||!i.tokenId||!(null===(e=l)||void 0===e?void 0:e.address)||!O||p.protocolVersion!==n.Qe.V4||O.protocolVersion!==n.Qe.V4||!i.pool||!i.liquidity)return;const d=p.pool??O.mockPool;if(!d)return;const m=$?O.tickSpaceLimits[0]:null===(t=O.ticks)||void 0===t?void 0:t[0],_=$?O.tickSpaceLimits[1]:null===(o=O.ticks)||void 0===o?void 0:o[1];return void 0!==m&&void 0!==_&&i.pool&&i.liquidity?{simulateTransaction:!G,inputProtocol:T.X.V3,tokenId:Number(i.tokenId),inputPosition:{pool:{token0:i.currency0Amount.currency.isNative?f.r_:i.currency0Amount.currency.address,token1:i.currency1Amount.currency.isNative?f.r_:i.currency1Amount.currency.address,fee:i.feeTier?Number(i.feeTier):void 0,tickSpacing:(null===(r=i)||void 0===r?void 0:r.tickSpacing)?Number(null===(s=i)||void 0===s?void 0:s.tickSpacing):void 0},tickLower:i.tickLower?Number(i.tickLower):void 0,tickUpper:i.tickUpper?Number(i.tickUpper):void 0},inputPoolLiquidity:i.pool.liquidity.toString(),inputCurrentTick:i.pool.tickCurrent,inputSqrtRatioX96:null===(a=i.pool.sqrtRatioX96)||void 0===a?void 0:a.toString(),inputPositionLiquidity:i.liquidity,outputProtocol:T.X.V4,outputPosition:{pool:{token0:(0,g.d2)(d.currency0),token1:(0,g.d2)(d.currency1),fee:x.fee.feeAmount,hooks:x.hook,tickSpacing:d.tickSpacing},tickLower:m,tickUpper:_},outputPoolLiquidity:p.creatingPoolOrPair?void 0:d.liquidity.toString(),outputSqrtRatioX96:p.creatingPoolOrPair?void 0:d.sqrtRatioX96.toString(),outputCurrentTick:p.creatingPoolOrPair?void 0:d.tickCurrent,initialPrice:p.creatingPoolOrPair?d.sqrtRatioX96.toString():void 0,chainId:i.currency0Amount.currency.chainId,walletAddress:l.address,expectedTokenOwed0RawAmount:(null===(c=C)||void 0===c?void 0:c.quotient.toString())??"0",expectedTokenOwed1RawAmount:(null===(u=B)||void 0===u?void 0:u.quotient.toString())??"0",amount0:i.currency0Amount.quotient.toString(),amount1:i.currency1Amount.quotient.toString()}:void 0}),[p,i,l,O,$,x.fee.feeAmount,x.hook,null===(r=C)||void 0===r?void 0:r.quotient,null===(s=B)||void 0===s?void 0:s.quotient,G]),X=O.protocolVersion!==n.Qe.V2&&!O.invalidPrice&&!O.invalidRange,Y=!((null===(a=m)||void 0===a?void 0:a.step.type)===E.c.MigratePositionTransactionStep||(null===(c=m)||void 0===c?void 0:c.step.type)===E.c.MigratePositionTransactionStepAsync)&&!F&&!Q&&Boolean(K)&&X,{data:Z,error:J,refetch:ee}=function({params:e,...i}){const t=[I.$.TradingApi,j.RJ.tradingApiPaths.migrate,e];return(0,k.a)({queryKey:t,queryFn:A((function*(){if(!e)throw{name:"Params are required"};return yield(0,S.YT)(e)})),...i})}({params:K,refetchInterval:!u&&5*D.Yb,retry:!1,enabled:Y});if((0,y.useEffect)((()=>{d(!!J)}),[J,K]),J){const e=(0,q.z)(J,{defaultTitle:"unknown MigrateLpPositionCalldataQuery"});M.k.error(e,{tags:{file:"MigrateV3LiquidityTxContext",function:"useEffect"}}),(0,R._)(w.d.MigrateLiquidityFailed,{message:e})}const ie=(0,y.useMemo)((()=>{var e,t,o;if(!Z)return;const r=(0,V.ad)(null===(e=W)||void 0===e?void 0:e.permitData);if((null===(t=W)||void 0===t?void 0:t.permitData)&&!r)return;const s=(0,V.Qd)(Z.migrate);if(!s)return;const a=_.CurrencyAmount.fromRawAmount((0,g.Ct)(i.currency0Amount.currency,n.Qe.V4),i.currency0Amount.quotient),c=_.CurrencyAmount.fromRawAmount((0,g.Ct)(i.currency1Amount.currency,n.Qe.V4),i.currency1Amount.quotient);return{type:N.d.Migrate,unsigned:Boolean(null===(o=W)||void 0===o?void 0:o.permitData),migratePositionRequestArgs:K,approveToken0Request:void 0,approveToken1Request:void 0,permit:r,protocolVersion:n.Qe.V3,approvePositionTokenRequest:void 0,revokeToken0Request:void 0,revokeToken1Request:void 0,txRequest:s,action:{type:N.d.Migrate,currency0Amount:a,currency1Amount:c}}}),[Z,K,W,i.currency0Amount,i.currency1Amount]);return(0,o.jsx)(z.Provider,{value:{txInfo:ie,error:(0,q.Z)({approvalError:Q,calldataError:J}),refetch:Q?U:J?ee:void 0},children:e})}var O=t(7483);var $=t(4314),H=t(20498),W=t(14839),F=t(75408),Q=t(70134),U=t(54746),G=t(68044),K=t(33900),X=t(39891),Y=t(58724),Z=t(56894),J=t(6534),ee=t(94202),ie=t(29360),te=t(81593),oe=t(56250),ne=t(86539),re=t(61321),se=t(78307),ae=t(16106),ce=t(96837),le=t(54620),ue=t(20423),de=t(60102),pe=t(62145),xe=t(53186),me=t(92494),_e=t(61869),ve=t(59458),fe=t(28734),he=t(2637),ge=t(49357),ye=t(52567),be=t(22729),ke=t(37667),je=t(48160),Se=t(51225),Ie=t(64824),Ce=t(23544);const Ae="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 _pr-t-space-pad1331704925 _pl-t-space-pad1331704925 _mt-t-space-spa94665593 _mb-t-space-spa94665593 ",Te="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _mb-t-space-spa1360334051 ",Pe="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-1 _flexDirection-column _backgroundColor-surface2 _borderTopLeftRadius-t-radius-ro291586453 _borderTopRightRadius-t-radius-ro291586453 _borderBottomRightRadius-t-radius-ro291586453 _borderBottomLeftRadius-t-radius-ro291586453 _pt-t-space-pad1331704929 _pr-t-space-pad1331704929 _pb-t-space-pad1331704929 _pl-t-space-pad1331704929 ",we="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _justifyContent-center _alignItems-center ",Re="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 _maxWidth-calcmin580p890974940 ",Ne="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _gap-32px _width-10037 ",qe="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _justifyContent-space-betwe3241 _alignItems-center _gap-t-space-gap1598 _width-10037 ",Ee="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _mt-t-space-spa1360333981 _gap-t-space-gap1635 ",Ve=(0,oe.z)(ne.or,{backgroundColor:"$surface1",display:"flex",flexDirection:"row",gap:60,mt:"1rem",mx:"auto",width:"100%",zIndex:"$default",p:24});function Me({positionInfo:e}){var i;const{chainName:t,tokenId:d}=(0,Z.UO)(),p=(0,Ie.o)(),{t:_}=(0,X.$G)(),{positionState:v,setPositionState:f,setStep:b,step:k,currentTransactionStep:j,setCurrentTransactionStep:S}=(0,h.kU)(),{protocolVersion:I}=v,{setPriceRangeState:C}=(0,h.$s)(),{setDepositState:A}=(0,h.EY)(),T=(0,fe.ye)(ve.TP.MigrateV3ToV4),[P,w]=(0,y.useState)([]),R=(0,m.Z)(),q=(0,L.m)().chainId,E=(0,xe.ii)(),V=(0,Y.I0)(),{txInfo:M,error:D,refetch:B}=function(){const e=(0,y.useContext)(z);if(!e)throw new Error("useMigrateV3TxContext must be used within a MigrateV3PositionTxContextProvider");return e}(),O=(0,re.GS)(),$=(0,Z.s0)(),G=()=>{S(void 0)},{currency0Amount:J,currency1Amount:oe,owner:ne}=e,me=(0,ye.NF)(J)??void 0,he=(0,ye.NF)(oe)??void 0;return T&&(0,Se.Wr)(null===(i=E)||void 0===i?void 0:i.address,ne)||$("/positions"),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:Ee,children:[(0,o.jsxs)(r.zG,{"aria-label":"breadcrumb-nav",children:[(0,o.jsxs)(r.yY,{to:"/positions",children:[(0,o.jsx)(X.cC,{i18nKey:"pool.positions.title"})," ",(0,o.jsx)(K.Z,{size:14})]}),(0,o.jsxs)(r.yY,{to:`/positions/v3/${t}/${d}`,children:[J.currency.symbol," / ",oe.currency.symbol," ",(0,o.jsx)(K.Z,{size:14})]})]}),(0,o.jsxs)("div",{className:qe,children:[(0,o.jsx)(se.xv,{width:"100%",variant:"heading2",children:(0,o.jsx)(X.cC,{i18nKey:"common.migrate.position"})}),(0,o.jsxs)(ae.k,{row:!0,backgroundColor:"$surface2",borderRadius:"$rounded12",alignItems:"center",justifyContent:"center",gap:"$gap4",py:"$padding8",px:"$padding12",...ie.G,onPress:()=>{f({...U.vF,protocolVersion:I,currencyInputs:{[te.R.TOKEN0]:(0,g.Ct)(J.currency,I),[te.R.TOKEN1]:(0,g.Ct)(oe.currency,I)}}),C(h.be),A(h.gr),b(U.bC.SELECT_TOKENS_AND_FEE_TIER)},children:[(0,o.jsx)(le.C,{color:"$neutral1",size:16}),(0,o.jsx)(se.xv,{variant:"buttonLabel4",color:"$neutral2",children:(0,o.jsx)(X.cC,{i18nKey:"common.button.reset"})})]})]}),(0,o.jsxs)("div",{className:Ne,children:[!O.xl&&(0,o.jsx)(ae.k,{width:360,alignSelf:"flex-start","$platform-web":{position:"sticky",top:ue.d+25},children:(0,o.jsx)(x.y,{steps:[{label:_("migrate.selectFeeTier"),active:k===U.bC.SELECT_TOKENS_AND_FEE_TIER},{label:_("migrate.setRange"),active:k===U.bC.PRICE_RANGE}]})}),(0,o.jsxs)("div",{className:Re,children:[(0,o.jsx)(c.T,{liquidityPosition:e,disabled:!0}),(0,o.jsx)("div",{className:we,children:(0,o.jsx)("div",{className:Pe,children:(0,o.jsx)(ce.K,{size:20,color:"$neutral1"})})}),k===U.bC.SELECT_TOKENS_AND_FEE_TIER?(0,o.jsx)(F.H,{width:"100%",maxWidth:"unset",tokensLocked:!0,onContinue:()=>{b(U.bC.PRICE_RANGE)}}):(0,o.jsx)(H.o,{width:"100%",maxWidth:"unset"}),k===U.bC.PRICE_RANGE&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Q.W2,{width:"100%",maxWidth:"unset",children:(0,o.jsx)(W.u,{positionInfo:e,onDisableContinue:!M||Boolean(D),onContinue:()=>{var i;const t=(0,N.l)(M);E&&(null===(i=E)||void 0===i?void 0:i.type)===_e.Q.SignerMnemonic&&t&&V(ee.h.actions.trigger({selectChain:R,startChainId:q,account:E,liquidityTxContext:M,setCurrentStep:S,setSteps:w,onSuccess:()=>{G(),$("/positions")},onFailure:G,analytics:{...(0,u.l)({trace:p,fee:e.feeTier,currency0:J.currency,currency1:oe.currency,currency0AmountUsd:me,currency1AmountUsd:he,poolId:e.poolId,version:n.Qe.V3}),action:"V3->V4"}}))}})}),(0,o.jsx)("div",{className:Te,children:(0,o.jsx)(s.p,{errorMessage:D,onPress:B})})]})]})]})]}),(0,o.jsxs)(pe.u,{name:ge.tl.MigrateLiquidity,onClose:G,isDismissible:!0,isModalOpen:Boolean(j),children:[(0,o.jsx)(a.w,{title:_("pool.migrateLiquidity"),closeModal:G}),(0,o.jsxs)("div",{className:Ae,children:[(0,o.jsx)(l.s,{currencyAmount:J,currencyUSDAmount:me,isMigrating:!0}),(0,o.jsx)(se.xv,{variant:"body3",color:"$neutral2",children:_("common.and")}),(0,o.jsx)(l.s,{currencyAmount:oe,currencyUSDAmount:he,isMigrating:!0})]}),(0,o.jsx)(de.Y,{steps:P,currentStep:j})]})]})}function De(){var e;const{tokenId:i}=(0,Z.UO)(),t=(0,Ce._4)(),r=(0,L.m)(),{data:s,isLoading:a}=(0,me.m)(r.address?{owner:r.address,protocolVersion:n.Qe.V3,tokenId:i,chainId:t??r.chainId}:void 0),c=null===(e=s)||void 0===e?void 0:e.position,l=(0,y.useMemo)((()=>(0,d.tS)(c)),[c]),u=function(e){return(0,y.useMemo)((()=>{if(!e)return;if(e.status!==n.H6.OUT_OF_RANGE)return;if(e.version!==n.Qe.V3)return;if(!e.pool)return;const i=Number(e.tickLower),t=Number(e.tickUpper),o=(0,O.B)(e.pool.token1).isNative;return{tickLower:o?-t:i,tickUpper:o?-i:t,isOutOfRange:e.status===n.H6.OUT_OF_RANGE}}),[e])}(l);if(a||!c||!l||l.version!==n.Qe.V3)return(0,o.jsx)(Ve,{children:(0,o.jsxs)(p.pr,{children:[(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{}),(0,o.jsx)(G.PI,{})]})});const{currency0Amount:x,currency1Amount:m,feeTier:_}=l;return(0,o.jsx)(he.Z,{logImpression:!0,page:ge.vk.MigrateV3,properties:{pool_address:l.poolId,chain_id:t??r.chainId,label:[x.currency.symbol,m.currency.symbol].join("/"),fee_tier:_,token0Address:(0,je.yl)((0,je.Hh)(x.currency)),token1Address:(0,je.yl)((0,je.Hh)(m.currency))},children:(0,o.jsx)(J.f,{initialChainId:t,children:(0,o.jsx)(be.Y7,{settingKey:ke.hM.LP,children:(0,o.jsx)($.gv,{initialState:{initialPosition:u,currencyInputs:{[te.R.TOKEN0]:(0,g.Ct)(x.currency,n.Qe.V4),[te.R.TOKEN1]:(0,g.Ct)(m.currency,n.Qe.V4)}},children:(0,o.jsx)($.g_,{children:(0,o.jsx)($.MJ,{children:(0,o.jsx)(B,{positionInfo:l,children:(0,o.jsx)(Me,{positionInfo:l})})})})})})})})}t(54023)},7483:(e,i,t)=>{t.d(i,{B:()=>n});var o=t(12761);function n(e){var i;return e.isNative?e:(null===(i=o.Fl[e.chainId])||void 0===i?void 0:i.equals(e))?(0,o.gX)(e.chainId):e}},92494:(e,i,t)=>{t.d(i,{m:()=>s});var o=t(40622),n=t(57946),r=t(10657);function s(e){return(0,o.a)(n.bt,e,{transport:r.b3,enabled:!!e})}}}]);
//# sourceMappingURL=5850.ce420b26.chunk.js.map